<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- saved from url=(0042)http://codeforces.com/contest/505/problems -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="X-Csrf-Token" content="c471660983ad9c17016d7aeb5094d8ce">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="c4">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="/static/images/codeforces-telegram-square.png">
    <meta property="og:title" content="Problems - Codeforces">
    <meta property="og:site_name" content="Codeforces">
    
    <meta name="cc" content="paa3hlq786lo">
    <meta name="pc" content="1p1t8jmpl7y7c">
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup">
    <meta name="robots" content="index, follow">

    <link rel="stylesheet" href="./Problems - Codeforces_files/font-awesome.min.css" type="text/css" charset="utf-8">

        <link href="./Problems - Codeforces_files/css" rel="stylesheet" type="text/css">


    <link rel="shortcut icon" type="image/png" href="http://codeforces.com/static/favicon.png">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="./Problems - Codeforces_files/prettify.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/clear.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/ttypography.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/problem-statement.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/second-level-menu.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/roundbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/datatable.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/table-form.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/topic.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/jquery.jgrowl.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/facebox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/jquery.wysiwyg.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/jquery.autocomplete.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/codeforces.datepick.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/colorbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/jquery.drafts.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="./Problems - Codeforces_files/sidebar-menu.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="./Problems - Codeforces_files/community.css" type="text/css" charset="utf-8">

    <script type="text/javascript" async="" src="./Problems - Codeforces_files/ga.js"></script><script type="text/javascript" src="./Problems - Codeforces_files/prettify.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/jquery-1.8.3.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/sockjs-0.2.1.min.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/vertxbus-1.2.min.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/jquery.easing.min.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/facebox.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/wysiwyg.table.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/wysiwyg.image.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/wysiwyg.link.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/jquery.datepick.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/jquery.drafts.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/codeforces.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="./Problems - Codeforces_files/style(1).css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./Problems - Codeforces_files/style(2).css" type="text/css" charset="utf-8">

    <script type="text/javascript" src="./Problems - Codeforces_files/share.js" charset="utf-8"></script>
    
    <script type="text/javascript" src="./Problems - Codeforces_files/jquery.markitup.js"></script>
    <script type="text/javascript" src="./Problems - Codeforces_files/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->


<style type="text/css"></style></head>
<body><span style="display:none;" class="csrf-token" data-csrf="c471660983ad9c17016d7aeb5094d8ce">&nbsp;</span>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 30px;"><i class="icon-circle-arrow-up"></i></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function() {
    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();

        var count = 0;

        function getDelay() {
            var delay = 0;
            var last = Codeforces.getCookie("lastOnlineTimeUpdaterInvocation");
            if (last && last != null) {
                var period = count < 20 ? 180 * 1000 : 360 * 1000;
                delay = period - (new Date().getTime() - last);
                if (delay < 0)
                    delay = 0;
            }
            return delay;
        }

        window.setInterval(function() {
            if (getDelay() <= 0 && count < 120) {
                count++;
                Codeforces.ping("/data/update-online");
            }
        }, 5000);

        var handle = "Royalmiki";
        $("a.rated-user:contains(" + handle + "), span.participant:contains(" + handle + ")").each(function() {
            if ($(this).text() == handle) {
                var td = $(this).parent();
                var tr = $(this).parent().parent();
                if (td.is("td") && tr.is("tr")) {
                    tr.addClass("highlighted-row");
                }
            }
        });

        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function () {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = (document.location.protocol == 'https:' ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">
<div style="width: 950px; margin: 0 auto;">
    <div id="header" style="position:relative;">
        <div style="float:left;">
                <a href="http://codeforces.com/"><img src="./Problems - Codeforces_files/codeforces-logo-with-telegram.png"></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="http://codeforces.com/contest/505/problems?locale=en"><img src="./Problems - Codeforces_files/gb.png" title="In English" alt="In English"></a>
                <a href="http://codeforces.com/contest/505/problems?locale=ru"><img src="./Problems - Codeforces_files/ru.png" title="По-русски" alt="По-русски"></a>
            </div>
        </div>
        <br style="clear: both;">
    </div>

    <div style="text-align: center;font-size: 18px;margin-bottom: 0.5em;" class="caption">Codeforces Round #286 (Div. 2)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

        <div style="margin-bottom: 4em;page-break-after: always;">
<!-- Frame: ProblemViewFrame.ftl -->
<div class="problemindexholder" problemindex="A">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Mr. Kitayuta's Gift</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Mr. Kitayuta has kindly given you a string <span class="tex-span"><i>s</i></span> consisting of lowercase English letters. You are asked to insert exactly one lowercase English letter into <span class="tex-span"><i>s</i></span> to make it a palindrome. A <span class="tex-font-style-it">palindrome</span> is a string that reads the same forward and backward. For example, "<span class="tex-font-style-tt">noon</span>", "<span class="tex-font-style-tt">testset</span>" and "<span class="tex-font-style-tt">a</span>" are all palindromes, while "<span class="tex-font-style-tt">test</span>" and "<span class="tex-font-style-tt">kitayuta</span>" are not.</p><p>You can choose any lowercase English letter, and insert it to any position of <span class="tex-span"><i>s</i></span>, possibly to the beginning or the end of <span class="tex-span"><i>s</i></span>. You have to insert a letter even if the given string is already a palindrome.</p><p>If it is possible to insert one lowercase English letter into <span class="tex-span"><i>s</i></span> so that the resulting string will be a palindrome, print the string after the insertion. Otherwise, print "<span class="tex-font-style-tt">NA</span>" (without quotes, case-sensitive). In case there is more than one palindrome that can be obtained, you are allowed to print any of them.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The only line of the input contains a string <span class="tex-span"><i>s</i></span> (<span class="tex-span">1 ≤ |<i>s</i>| ≤ 10</span>). Each character in <span class="tex-span"><i>s</i></span> is a lowercase English letter.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If it is possible to turn <span class="tex-span"><i>s</i></span> into a palindrome by inserting one lowercase English letter, print the resulting string in a single line. Otherwise, print "<span class="tex-font-style-tt">NA</span>" (without quotes, case-sensitive). In case there is more than one solution, any of them will be accepted. </p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>revive<br></pre></div><div class="output"><div class="title">Output</div><pre>reviver<br></pre></div><div class="input"><div class="title">Input</div><pre>ee<br></pre></div><div class="output"><div class="title">Output</div><pre>eye</pre></div><div class="input"><div class="title">Input</div><pre>kitayuta<br></pre></div><div class="output"><div class="title">Output</div><pre>NA<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>For the first sample, insert '<span class="tex-font-style-tt">r</span>' to the end of "<span class="tex-font-style-tt">revive</span>" to obtain a palindrome "<span class="tex-font-style-tt">reviver</span>".</p><p>For the second sample, there is more than one solution. For example, "<span class="tex-font-style-tt">eve</span>" will also be accepted.</p><p>For the third sample, it is not possible to turn "<span class="tex-font-style-tt">kitayuta</span>" into a palindrome by just inserting one letter.</p></div></div></div>
</div>


<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        var titleDiv = $("div.header div.title");



    });
</script>
<!-- /Frame: ProblemViewFrame.ftl -->        </div>
        <div style="margin-bottom: 4em;page-break-after: always;">
<!-- Frame: ProblemViewFrame.ftl -->
<div class="problemindexholder" problemindex="B">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Mr. Kitayuta's Colorful Graph</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Mr. Kitayuta has just bought an undirected graph consisting of <span class="tex-span"><i>n</i></span> vertices and <span class="tex-span"><i>m</i></span> edges. The vertices of the graph are numbered from 1 to <span class="tex-span"><i>n</i></span>. Each edge, namely edge <span class="tex-span"><i>i</i></span>, has a color <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>, connecting vertex <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>Mr. Kitayuta wants you to process the following <span class="tex-span"><i>q</i></span> queries.</p><p>In the <span class="tex-span"><i>i</i></span>-th query, he gives you two integers — <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>Find the number of the colors that satisfy the following condition: the edges of that color connect vertex <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> and vertex <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> directly or indirectly.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains space-separated two integers — <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 100, 1 ≤ <i>m</i> ≤ 100</span>), denoting the number of the vertices and the number of the edges, respectively.</p><p>The next <span class="tex-span"><i>m</i></span> lines contain space-separated three integers — <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> &lt; <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>) and <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ <i>m</i></span>). Note that there can be multiple edges between two vertices. However, there are no multiple edges of the same color between two vertices, that is, if <span class="tex-span"><i>i</i> ≠ <i>j</i></span>, <span class="tex-span">(<i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>, <i>c</i><sub class="lower-index"><i>i</i></sub>) ≠ (<i>a</i><sub class="lower-index"><i>j</i></sub>, <i>b</i><sub class="lower-index"><i>j</i></sub>, <i>c</i><sub class="lower-index"><i>j</i></sub>)</span>.</p><p>The next line contains a integer — <span class="tex-span"><i>q</i></span> (<span class="tex-span">1 ≤ <i>q</i> ≤ 100</span>), denoting the number of the queries.</p><p>Then follows <span class="tex-span"><i>q</i></span> lines, containing space-separated two integers — <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>u</i><sub class="lower-index"><i>i</i></sub>, <i>v</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>). It is guaranteed that <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub> ≠ <i>v</i><sub class="lower-index"><i>i</i></sub></span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each query, print the answer in a separate line.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 5<br>1 2 1<br>1 2 2<br>2 3 1<br>2 3 3<br>2 4 3<br>3<br>1 2<br>3 4<br>1 4<br></pre></div><div class="output"><div class="title">Output</div><pre>2<br>1<br>0<br></pre></div><div class="input"><div class="title">Input</div><pre>5 7<br>1 5 1<br>2 5 1<br>3 5 1<br>4 5 1<br>1 2 2<br>2 3 2<br>3 4 2<br>5<br>1 5<br>5 1<br>2 5<br>1 5<br>1 4<br></pre></div><div class="output"><div class="title">Output</div><pre>1<br>1<br>1<br>1<br>2<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Let's consider the first sample. </p><center> <img class="tex-graphics" src="./Problems - Codeforces_files/d61cb1423342776f2295bc90083a0a84f5a70c56.png">   The figure above shows the first sample. </center> <ul> <li> Vertex <span class="tex-span">1</span> and vertex <span class="tex-span">2</span> are connected by color <span class="tex-span">1</span> and <span class="tex-span">2</span>. </li><li> Vertex <span class="tex-span">3</span> and vertex <span class="tex-span">4</span> are connected by color <span class="tex-span">3</span>. </li><li> Vertex <span class="tex-span">1</span> and vertex <span class="tex-span">4</span> are not connected by any single color. </li></ul></div></div></div>
</div>


<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        var titleDiv = $("div.header div.title");



    });
</script>
<!-- /Frame: ProblemViewFrame.ftl -->        </div>
        <div style="margin-bottom: 4em;page-break-after: always;">
<!-- Frame: ProblemViewFrame.ftl -->
<div class="problemindexholder" problemindex="C">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Mr. Kitayuta, the Treasure Hunter</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Shuseki Islands are an archipelago of <span class="tex-span">30001</span> small islands in the Yutampo Sea. The islands are evenly spaced along a line, numbered from <span class="tex-span">0</span> to <span class="tex-span">30000</span> from the west to the east. These islands are known to contain many treasures. There are <span class="tex-span"><i>n</i></span> gems in the Shuseki Islands in total, and the <span class="tex-span"><i>i</i></span>-th gem is located on island <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>Mr. Kitayuta has just arrived at island <span class="tex-span">0</span>. With his great jumping ability, he will repeatedly perform jumps between islands to the east according to the following process: </p><ul> <li> First, he will jump from island <span class="tex-span">0</span> to island <span class="tex-span"><i>d</i></span>. </li><li> After that, he will continue jumping according to the following rule. Let <span class="tex-span"><i>l</i></span> be the length of the previous jump, that is, if his previous jump was from island <span class="tex-span"><i>prev</i></span> to island <span class="tex-span"><i>cur</i></span>, let <span class="tex-span"><i>l</i> = <i>cur</i> - <i>prev</i></span>. He will perform a jump of length <span class="tex-span"><i>l</i> - 1</span>, <span class="tex-span"><i>l</i></span> or <span class="tex-span"><i>l</i> + 1</span> to the east. That is, he will jump to island <span class="tex-span">(<i>cur</i> + <i>l</i> - 1)</span>, <span class="tex-span">(<i>cur</i> + <i>l</i>)</span> or <span class="tex-span">(<i>cur</i> + <i>l</i> + 1)</span> (if they exist). The length of a jump must be positive, that is, he cannot perform a jump of length <span class="tex-span">0</span> when <span class="tex-span"><i>l</i> = 1</span>. If there is no valid destination, he will stop jumping. </li></ul><p>Mr. Kitayuta will collect the gems on the islands visited during the process. Find the maximum number of gems that he can collect.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains two space-separated integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>d</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>d</i> ≤ 30000</span>), denoting the number of the gems in the Shuseki Islands and the length of the Mr. Kitayuta's first jump, respectively.</p><p>The next <span class="tex-span"><i>n</i></span> lines describe the location of the gems. The <span class="tex-span"><i>i</i></span>-th of them (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>n</i></span>) contains a integer <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span"><i>d</i> ≤ <i>p</i><sub class="lower-index">1</sub> ≤ <i>p</i><sub class="lower-index">2</sub> ≤ ... ≤ <i>p</i><sub class="lower-index"><i>n</i></sub> ≤ 30000</span>), denoting the number of the island that contains the <span class="tex-span"><i>i</i></span>-th gem.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the maximum number of gems that Mr. Kitayuta can collect.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 10<br>10<br>21<br>27<br>27<br></pre></div><div class="output"><div class="title">Output</div><pre>3<br></pre></div><div class="input"><div class="title">Input</div><pre>8 8<br>9<br>19<br>28<br>36<br>45<br>55<br>66<br>78<br></pre></div><div class="output"><div class="title">Output</div><pre>6<br></pre></div><div class="input"><div class="title">Input</div><pre>13 7<br>8<br>8<br>9<br>16<br>17<br>17<br>18<br>21<br>23<br>24<br>24<br>26<br>30<br></pre></div><div class="output"><div class="title">Output</div><pre>4<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, the optimal route is 0 <span class="tex-span"> → </span> 10 (+1 gem) <span class="tex-span"> → </span> 19 <span class="tex-span"> → </span> 27 (+2 gems) <span class="tex-span"> → ...</span></p><p>In the second sample, the optimal route is 0 <span class="tex-span"> → </span> 8 <span class="tex-span"> → </span> 15 <span class="tex-span"> → </span> 21<span class="tex-span"> → </span> 28 (+1 gem) <span class="tex-span"> → </span> 36 (+1 gem) <span class="tex-span"> → </span> 45 (+1 gem) <span class="tex-span"> → </span> 55 (+1 gem) <span class="tex-span"> → </span> 66 (+1 gem) <span class="tex-span"> → </span> 78 (+1 gem) <span class="tex-span"> → ...</span></p><p>In the third sample, the optimal route is 0 <span class="tex-span"> → </span> 7 <span class="tex-span"> → </span> 13 <span class="tex-span"> → </span> 18 (+1 gem) <span class="tex-span"> → </span> 24 (+2 gems) <span class="tex-span"> → </span> 30 (+1 gem) <span class="tex-span"> → ...</span></p></div></div></div>
</div>


<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        var titleDiv = $("div.header div.title");



    });
</script>
<!-- /Frame: ProblemViewFrame.ftl -->        </div>
        <div style="margin-bottom: 4em;page-break-after: always;">
<!-- Frame: ProblemViewFrame.ftl -->
<div class="problemindexholder" problemindex="D">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Mr. Kitayuta's Technology</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Shuseki Kingdom is the world's leading nation for innovation and technology. There are <span class="tex-span"><i>n</i></span> cities in the kingdom, numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>.</p><p>Thanks to Mr. Kitayuta's research, it has finally become possible to construct teleportation pipes between two cities. A teleportation pipe will connect two cities unidirectionally, that is, a teleportation pipe from city <span class="tex-span"><i>x</i></span> to city <span class="tex-span"><i>y</i></span> cannot be used to travel from city <span class="tex-span"><i>y</i></span> to city <span class="tex-span"><i>x</i></span>. The transportation within each city is extremely developed, therefore if a pipe from city <span class="tex-span"><i>x</i></span> to city <span class="tex-span"><i>y</i></span> and a pipe from city <span class="tex-span"><i>y</i></span> to city <span class="tex-span"><i>z</i></span> are both constructed, people will be able to travel from city <span class="tex-span"><i>x</i></span> to city <span class="tex-span"><i>z</i></span> instantly.</p><p>Mr. Kitayuta is also involved in national politics. He considers that the transportation between the <span class="tex-span"><i>m</i></span> pairs of city <span class="tex-span">(<i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>)</span> (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>m</i></span>) is important. He is planning to construct teleportation pipes so that for each important pair <span class="tex-span">(<i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>)</span>, it will be possible to travel from city <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> to city <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> by using one or more teleportation pipes (but not necessarily from city <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> to city <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>). Find the minimum number of teleportation pipes that need to be constructed. So far, no teleportation pipe has been constructed, and there is no other effective transportation between cities.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two space-separated integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup>, 1 ≤ <i>m</i> ≤ 10<sup class="upper-index">5</sup></span>), denoting the number of the cities in Shuseki Kingdom and the number of the important pairs, respectively.</p><p>The following <span class="tex-span"><i>m</i></span> lines describe the important pairs. The <span class="tex-span"><i>i</i></span>-th of them (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>m</i></span>) contains two space-separated integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>, <i>a</i><sub class="lower-index"><i>i</i></sub> ≠ <i>b</i><sub class="lower-index"><i>i</i></sub></span>), denoting that it must be possible to travel from city <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> to city <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> by using one or more teleportation pipes (but not necessarily from city <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> to city <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>). It is guaranteed that all pairs <span class="tex-span">(<i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>)</span> are distinct.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the minimum required number of teleportation pipes to fulfill Mr. Kitayuta's purpose.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 5<br>1 2<br>1 3<br>1 4<br>2 3<br>2 4<br></pre></div><div class="output"><div class="title">Output</div><pre>3<br></pre></div><div class="input"><div class="title">Input</div><pre>4 6<br>1 2<br>1 4<br>2 3<br>2 4<br>3 2<br>3 4<br></pre></div><div class="output"><div class="title">Output</div><pre>4<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>For the first sample, one of the optimal ways to construct pipes is shown in the image below: </p><center> <img class="tex-graphics" src="./Problems - Codeforces_files/76160626a96f3941a2707e16a7fafd4d2cf5a326.png"> </center><p>For the second sample, one of the optimal ways is shown below: </p><center> <img class="tex-graphics" src="./Problems - Codeforces_files/b9d749d8f72cd134cc2b14ff73276c4a604e8fa3.png"> </center></div></div></div>
</div>


<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        var titleDiv = $("div.header div.title");



    });
</script>
<!-- /Frame: ProblemViewFrame.ftl -->        </div>
        <div style="margin-bottom: 2em;">
<!-- Frame: ProblemViewFrame.ftl -->
<div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Mr. Kitayuta vs. Bamboos</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Mr. Kitayuta's garden is planted with <span class="tex-span"><i>n</i></span> bamboos. (Bamboos are tall, fast-growing tropical plants with hollow stems.) At the moment, the height of the <span class="tex-span"><i>i</i></span>-th bamboo is <span class="tex-span"><i>h</i><sub class="lower-index"><i>i</i></sub></span> meters, and it grows <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> meters at the end of each day. </p><p>Actually, Mr. Kitayuta hates these bamboos. He once attempted to cut them down, but failed because their stems are too hard. Mr. Kitayuta have not given up, however. He has crafted Magical Hammer with his intelligence to drive them into the ground.</p><p>He can use Magical Hammer at most <span class="tex-span"><i>k</i></span> times during each day, due to his limited Magic Power. Each time he beat a bamboo with Magical Hammer, its height decreases by <span class="tex-span"><i>p</i></span> meters. If the height would become negative by this change, it will become <span class="tex-span">0</span> meters instead (it does not disappear). In other words, if a bamboo whose height is <span class="tex-span"><i>h</i></span> meters is beaten with Magical Hammer, its new height will be <span class="tex-span"><i>max</i>(0, <i>h</i> - <i>p</i>)</span> meters. It is possible to beat the same bamboo more than once in a day.</p><p>Mr. Kitayuta will fight the bamboos for <span class="tex-span"><i>m</i></span> days, starting today. His purpose is to minimize the height of the tallest bamboo after <span class="tex-span"><i>m</i></span> days (that is, <span class="tex-span"><i>m</i></span> iterations of "Mr. Kitayuta beats the bamboos and then they grow"). Find the lowest possible height of the tallest bamboo after <span class="tex-span"><i>m</i></span> days.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains four space-separated integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span>, <span class="tex-span"><i>k</i></span> and <span class="tex-span"><i>p</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup>, 1 ≤ <i>m</i> ≤ 5000, 1 ≤ <i>k</i> ≤ 10, 1 ≤ <i>p</i> ≤ 10<sup class="upper-index">9</sup></span>). They represent the number of the bamboos in Mr. Kitayuta's garden, the duration of Mr. Kitayuta's fight in days, the maximum number of times that Mr. Kitayuta beat the bamboos during each day, and the power of Magic Hammer, respectively.</p><p>The following <span class="tex-span"><i>n</i></span> lines describe the properties of the bamboos. The <span class="tex-span"><i>i</i></span>-th of them (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>n</i></span>) contains two space-separated integers <span class="tex-span"><i>h</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">0 ≤ <i>h</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup>, 1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>), denoting the initial height and the growth rate of the <span class="tex-span"><i>i</i></span>-th bamboo, respectively.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the lowest possible height of the tallest bamboo after <span class="tex-span"><i>m</i></span> days.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 1 2 5<br>10 10<br>10 10<br>15 2<br></pre></div><div class="output"><div class="title">Output</div><pre>17<br></pre></div><div class="input"><div class="title">Input</div><pre>2 10 10 1000000000<br>0 10<br>0 10<br></pre></div><div class="output"><div class="title">Output</div><pre>10<br></pre></div><div class="input"><div class="title">Input</div><pre>5 3 3 10<br>9 5<br>9 2<br>4 7<br>9 10<br>3 8<br></pre></div><div class="output"><div class="title">Output</div><pre>14<br></pre></div></div></div></div></div>
</div>


<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        var titleDiv = $("div.header div.title");



    });
</script>
<!-- /Frame: ProblemViewFrame.ftl -->        </div>

    <br style="clear:both;">

    <div id="footer">
        <div><a href="http://codeforces.com/">Codeforces</a> (c) Copyright 2010-2014 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>
</div>
</div>


<!-- /Page: CompleteProblemsViewPage.ftl --><div id="datepick-div" style="display: none;"></div><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="display: none; padding-bottom: 42px; padding-right: 42px;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div></body></html>